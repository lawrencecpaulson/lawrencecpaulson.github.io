%
\begin{isabellebody}%
\setisabellecontext{Gowers{\isacharunderscore}{\kern0pt}Bijection}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Tim Gowers' Example: A Characterisation of Bijections%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Gowers{\isacharunderscore}{\kern0pt}Bijection\ \isakeywordTWO{imports}\ Complex{\isacharunderscore}{\kern0pt}Main\isanewline
\ \ \ \isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
Isabelle's default syntax for set difference is nonstandard.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}difference\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}a\ set{\isacharbrackright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeywordTWO{infixl}\ {\isachardoublequoteopen}{\isasymsetminus}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTWO{where}\ {\isachardoublequoteopen}A\ {\isasymsetminus}\ B\ {\isasymequiv}\ A{\isacharminus}{\kern0pt}B{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The one-line proof found by sledgehammer%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ f\ X\ Y\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A{\isachardot}{\kern0pt}\ A{\isasymsubseteq}X\ {\isasymlongrightarrow}\ f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isasymsetminus}A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Y\ {\isasymsetminus}\ f{\isacharbackquote}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Diff{\isacharunderscore}{\kern0pt}empty\ Diff{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}iff\ Diff{\isacharunderscore}{\kern0pt}subset\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ image{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}diff\ subset{\isacharunderscore}{\kern0pt}antisym\ subset{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
A more detailed proof. Note use of variables for the left and right sides%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ f\ X\ Y\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A{\isachardot}{\kern0pt}\ A{\isasymsubseteq}X\ {\isasymlongrightarrow}\ f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isasymsetminus}A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Y\ {\isasymsetminus}\ f{\isacharbackquote}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}L{\isacharequal}{\kern0pt}{\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}L\ {\isasymLongrightarrow}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Diff{\isacharunderscore}{\kern0pt}subset\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}R\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ f\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}f\ {\isacharbackquote}{\kern0pt}\ X\ {\isacharequal}{\kern0pt}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}L\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Bonus: an example due to Terrence Tao%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\isanewline
\ \ \isakeywordTWO{fixes}\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}decseq\ a{\isachardoublequoteclose}\ \isakeywordTWO{and}\ D{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}k{\isachardot}{\kern0pt}\ D\ k\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeywordTWO{and}\ aD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}k{\isachardot}{\kern0pt}\ a\ k\ {\isasymle}\ D\ k\ {\isacharminus}{\kern0pt}\ D{\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}a\ k\ {\isasymle}\ D\ {\isadigit{0}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymle}k{\isachardot}{\kern0pt}\ a\ k{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymle}k{\isachardot}{\kern0pt}\ a\ i{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ a\ sum{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymlambda}i{\isachardot}{\kern0pt}\ a\ k{\isachardoublequoteclose}\ a{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ monotone{\isacharunderscore}{\kern0pt}def\ divide{\isacharunderscore}{\kern0pt}simps\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymle}k{\isachardot}{\kern0pt}\ D\ i\ {\isacharminus}{\kern0pt}\ D{\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ aD\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ D\ {\isadigit{0}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}telescope\ D\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Internet/MachineLogic/Isabelle-Examples/Gowers_Bijection.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%39=7%:%
%:%41=8%:%
%:%42=8%:%
%:%43=9%:%
%:%45=11%:%
%:%47=12%:%
%:%48=12%:%
%:%51=13%:%
%:%55=13%:%
%:%56=13%:%
%:%57=14%:%
%:%66=16%:%
%:%68=17%:%
%:%69=17%:%
%:%76=18%:%
%:%77=18%:%
%:%78=19%:%
%:%79=19%:%
%:%80=20%:%
%:%81=20%:%
%:%82=21%:%
%:%83=21%:%
%:%84=22%:%
%:%85=22%:%
%:%86=22%:%
%:%87=23%:%
%:%88=23%:%
%:%89=24%:%
%:%90=24%:%
%:%91=24%:%
%:%92=25%:%
%:%93=25%:%
%:%94=26%:%
%:%104=28%:%
%:%106=30%:%
%:%107=30%:%
%:%108=31%:%
%:%109=32%:%
%:%110=33%:%
%:%117=34%:%
%:%118=34%:%
%:%119=35%:%
%:%120=35%:%
%:%121=36%:%
%:%122=36%:%
%:%123=37%:%
%:%124=37%:%
%:%125=37%:%
%:%126=38%:%
%:%127=38%:%
%:%128=39%:%
%:%129=39%:%
%:%130=40%:%
%:%131=40%:%
%:%132=40%:%
%:%133=41%:%
%:%134=41%:%
%:%135=42%:%
%:%136=42%:%
%:%137=42%:%
%:%138=43%:%
%:%139=43%:%
%:%140=44%:%
%:%141=44%:%
%:%142=44%:%
%:%143=44%:%
%:%144=45%:%
%:%150=45%:%
%:%155=46%:%
%:%160=47%:%
