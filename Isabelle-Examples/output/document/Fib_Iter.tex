%
\begin{isabellebody}%
\setisabellecontext{Fib{\isacharunderscore}{\kern0pt}Iter}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Iterative Fibonacci and Code Generation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Fib{\isacharunderscore}{\kern0pt}Iter\isanewline
\ \ \isakeywordTWO{imports}\ Complex{\isacharunderscore}{\kern0pt}Main\ \ %
\isamarkupcmt{allows implicit coercions%
}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
The type of integers banishes the successor function%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{fun}\isamarkupfalse%
\ itfib\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}int{\isacharcomma}{\kern0pt}int{\isacharcomma}{\kern0pt}int{\isacharbrackright}{\kern0pt}\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}itfib\ n\ j\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ n{\isasymle}{\isadigit{1}}\ then\ k\ else\ itfib\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ k\ {\isacharparenleft}{\kern0pt}j{\isacharplus}{\kern0pt}k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Simplification alone can compute this colossal number
   in a fraction of a second%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}itfib\ {\isadigit{2}}{\isadigit{0}}{\isadigit{0}}\ {\isadigit{0}}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}{\isadigit{8}}{\isadigit{0}}{\isadigit{5}}{\isadigit{7}}{\isadigit{1}}{\isadigit{1}}{\isadigit{7}}{\isadigit{2}}{\isadigit{9}}{\isadigit{9}}{\isadigit{2}}{\isadigit{5}}{\isadigit{1}}{\isadigit{0}}{\isadigit{1}}{\isadigit{4}}{\isadigit{0}}{\isadigit{0}}{\isadigit{3}}{\isadigit{7}}{\isadigit{6}}{\isadigit{1}}{\isadigit{1}}{\isadigit{9}}{\isadigit{3}}{\isadigit{2}}{\isadigit{4}}{\isadigit{1}}{\isadigit{3}}{\isadigit{0}}{\isadigit{3}}{\isadigit{8}}{\isadigit{6}}{\isadigit{7}}{\isadigit{7}}{\isadigit{1}}{\isadigit{8}}{\isadigit{9}}{\isadigit{5}}{\isadigit{2}}{\isadigit{5}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{fun}\isamarkupfalse%
\ fib\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}fib\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}fib\ {\isacharparenleft}{\kern0pt}Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}fib\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fib\ n\ {\isacharplus}{\kern0pt}\ fib\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The two functions are closely related%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ itfib{\isacharunderscore}{\kern0pt}fib{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ itfib\ n\ {\isacharparenleft}{\kern0pt}fib\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fib{\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fib\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ itfib\ n\ {\isacharparenleft}{\kern0pt}fib\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fib\ k\ {\isacharplus}{\kern0pt}\ fib\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fib\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}n{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Suc{\isachardot}{\kern0pt}IH\ Suc{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}plus{\isadigit{1}}\ add{\isachardot}{\kern0pt}commute\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ fib{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Direct recursive evaluation is exponential and slow%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}fib\ {\isadigit{4}}{\isadigit{4}}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{declare}\isamarkupfalse%
\ fib{\isachardot}{\kern0pt}simps\ {\isacharbrackleft}{\kern0pt}code\ del{\isacharbrackright}{\kern0pt}%
\begin{isamarkuptext}%
New code equation for \isa{\isaconst{fib}}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ fib{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}itfib{\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fib\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ n{\isacharequal}{\kern0pt}{\isadigit{0}}\ then\ {\isadigit{0}}\ else\ itfib\ {\isacharparenleft}{\kern0pt}int\ n{\isacharparenright}{\kern0pt}\ {\isadigit{0}}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ itfib{\isacharunderscore}{\kern0pt}fib\ {\isacharbrackleft}{\kern0pt}of\ n\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
FAST%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{value}\isamarkupfalse%
\ {\isachardoublequoteopen}fib\ {\isadigit{2}}{\isadigit{0}}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Internet/MachineLogic/Isabelle-Examples/Fib_Iter.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=4%:%
%:%31=4%:%
%:%32=5%:%
%:%41=7%:%
%:%43=8%:%
%:%44=8%:%
%:%45=9%:%
%:%47=11%:%
%:%48=12%:%
%:%50=13%:%
%:%51=13%:%
%:%54=14%:%
%:%58=14%:%
%:%59=14%:%
%:%64=14%:%
%:%67=15%:%
%:%68=16%:%
%:%69=16%:%
%:%70=17%:%
%:%71=18%:%
%:%72=19%:%
%:%74=21%:%
%:%76=22%:%
%:%77=22%:%
%:%84=23%:%
%:%85=23%:%
%:%86=24%:%
%:%87=24%:%
%:%88=25%:%
%:%89=25%:%
%:%90=25%:%
%:%91=26%:%
%:%92=26%:%
%:%93=27%:%
%:%94=27%:%
%:%95=28%:%
%:%96=28%:%
%:%97=29%:%
%:%98=29%:%
%:%99=30%:%
%:%100=30%:%
%:%101=31%:%
%:%102=31%:%
%:%103=31%:%
%:%104=32%:%
%:%105=32%:%
%:%106=33%:%
%:%116=35%:%
%:%118=36%:%
%:%119=36%:%
%:%120=37%:%
%:%121=38%:%
%:%122=38%:%
%:%124=40%:%
%:%126=41%:%
%:%127=41%:%
%:%130=42%:%
%:%134=42%:%
%:%135=42%:%
%:%136=42%:%
%:%145=44%:%
%:%147=45%:%
%:%148=45%:%
%:%151=46%:%
%:%156=47%:%
